let arr = [{
        "userId": 1,
        "id": 1,
        'time': '12:24',
        "title": "delectus aut autem",
        "completed": false
    },
    {
        "userId": 1,
        "id": 2,
        'time': '12:24',
        "title": "quis ut nam facilis et officia qui",
        "completed": false
    },
    {
        "userId": 1,
        "id": 3,
        'time': '12:24',
        "title": "fugiat veniam minus",
        "completed": false
    },
    {
        "userId": 1,
        "id": 4,
        'time': '12:24',
        "title": "et porro tempora",
        "completed": true
    },
    {
        "userId": 1,
        "id": 5,
        'time': '12:24',
        "title": "laboriosam mollitia et enim quasi adipisci quia provident illum",
        "completed": false
    },
    {
        "userId": 1,
        "id": 6,
        'time': '12:24',
        "title": "qui ullam ratione quibusdam voluptatem quia omnis",
        "completed": false
    },
    {
        "userId": 1,
        "id": 7,
        'time': '12:24',
        "title": "illo expedita consequatur quia in",
        "completed": false
    },
    {
        "userId": 1,
        "id": 8,
        'time': '12:24',
        "title": "quo adipisci enim quam ut ab",
        "completed": true
    },
    {
        "userId": 1,
        "id": 9,
        'time': '12:24',
        "title": "molestiae perspiciatis ipsa",
        "completed": false
    },
    {
        "userId": 1,
        "id": 10,
        'time': '12:24',
        "title": "illo est ratione doloremque quia maiores aut",
        "completed": true
    },
    {
        "userId": 1,
        "id": 11,
        'time': '12:24',
        "title": "vero rerum temporibus dolor",
        "completed": true
    },
    {
        "userId": 1,
        "id": 12,
        'time': '12:24',
        "title": "ipsa repellendus fugit nisi",
        "completed": true
    },
    {
        "userId": 1,
        "id": 13,
        'time': '12:24',
        "title": "et doloremque nulla",
        "completed": false
    },
    {
        "userId": 1,
        "id": 14,
        'time': '12:24',
        "title": "repellendus sunt dolores architecto voluptatum",
        "completed": true
    },
    {
        "userId": 1,
        "id": 15,
        'time': '12:24',
        "title": "ab voluptatum amet voluptas",
        "completed": true
    },
    {
        "userId": 1,
        "id": 16,
        "title": "accusamus eos facilis sint et aut voluptatem",
        "completed": true
    },
    {
        "userId": 1,
        "id": 17,
        'time': '12:24',
        "title": "quo laboriosam deleniti aut qui",
        "completed": true
    },
    {
        "userId": 1,
        "id": 18,
        'time': '12:24',
        "title": "dolorum est consequatur ea mollitia in culpa",
        "completed": false
    },
    {
        "userId": 1,
        "id": 19,
        'time': '12:24',
        "title": "molestiae ipsa aut voluptatibus pariatur dolor nihil",
        "completed": true
    },
    {
        "userId": 1,
        "id": 20,
        'time': '12:24',
        "title": "ullam nobis libero sapiente ad optio sint",
        "completed": true
    },
    {
        "userId": 2,
        "id": 21,
        'time': '12:24',
        "title": "suscipit repellat esse quibusdam voluptatem incidunt",
        "completed": false
    },
    {
        "userId": 2,
        "id": 22,
        'time': '12:24',
        "title": "distinctio vitae autem nihil ut molestias quo",
        "completed": true
    },
    {
        "userId": 2,
        "id": 23,
        'time': '12:24',
        "title": "et itaque necessitatibus maxime molestiae qui quas velit",
        "completed": false
    },
    {
        "userId": 2,
        "id": 24,
        'time': '12:24',
        "title": "adipisci non ad dicta qui amet quaerat doloribus ea",
        "completed": false
    },
    {
        "userId": 2,
        "id": 25,
        'time': '12:24',
        "title": "voluptas quo tenetur perspiciatis explicabo natus",
        "completed": true
    },
    {
        "userId": 2,
        "id": 26,
        'time': '12:24',
        "title": "aliquam aut quasi",
        "completed": true
    },
    {
        "userId": 2,
        "id": 27,
        'time': '12:24',
        "title": "veritatis pariatur delectus",
        "completed": true
    },
    {
        "userId": 2,
        "id": 28,
        'time': '12:24',
        "title": "nesciunt totam sit blanditiis sit",
        "completed": false
    },
    {
        "userId": 2,
        "id": 29,
        'time': '12:24',
        "title": "laborum aut in quam",
        "completed": false
    },
    {
        "userId": 2,
        "id": 30,
        'time': '12:24',
        "title": "nemo perspiciatis repellat ut dolor libero commodi blanditiis omnis",
        "completed": true
    },
    {
        "userId": 2,
        "id": 31,
        'time': '12:24',
        "title": "repudiandae totam in est sint facere fuga",
        "completed": false
    },
    {
        "userId": 2,
        "id": 32,
        'time': '12:24',
        "title": "earum doloribus ea doloremque quis",
        "completed": false
    },
    {
        "userId": 2,
        "id": 33,
        'time': '12:24',
        "title": "sint sit aut vero",
        "completed": false
    },
    {
        "userId": 2,
        "id": 34,
        'time': '12:24',
        "title": "porro aut necessitatibus eaque distinctio",
        "completed": false
    },
    {
        "userId": 2,
        "id": 35,
        'time': '12:24',
        "title": "repellendus veritatis molestias dicta incidunt",
        "completed": true
    },
    {
        "userId": 2,
        "id": 36,
        'time': '12:24',
        "title": "excepturi deleniti adipisci voluptatem et neque optio illum ad",
        "completed": true
    },
    {
        "userId": 2,
        "id": 37,
        'time': '12:24',
        "title": "sunt cum tempora",
        "completed": false
    },
    {
        "userId": 2,
        "id": 38,
        'time': '12:24',
        "title": "totam quia non",
        "completed": false
    },
    {
        "userId": 2,
        "id": 39,
        'time': '12:24',
        "title": "doloremque quibusdam asperiores libero corrupti illum qui omnis",
        "completed": false
    },
    {
        "userId": 2,
        "id": 40,
        'time': '12:24',
        "title": "totam atque quo nesciunt",
        "completed": true
    },
    {
        "userId": 3,
        "id": 41,
        'time': '12:24',
        "title": "aliquid amet impedit consequatur aspernatur placeat eaque fugiat suscipit",
        "completed": false
    },
    {
        "userId": 3,
        "id": 42,
        'time': '12:24',
        "title": "rerum perferendis error quia ut eveniet",
        "completed": false
    },
    {
        "userId": 3,
        "id": 43,
        'time': '12:24',
        "title": "tempore ut sint quis recusandae",
        "completed": true
    },
    {
        "userId": 3,
        "id": 44,
        'time': '12:24',
        "title": "cum debitis quis accusamus doloremque ipsa natus sapiente omnis",
        "completed": true
    },
    {
        "userId": 3,
        "id": 45,
        'time': '12:24',
        "title": "velit soluta adipisci molestias reiciendis harum",
        "completed": false
    },
    {
        "userId": 3,
        "id": 46,
        'time': '12:24',
        "title": "vel voluptatem repellat nihil placeat corporis",
        "completed": false
    },
    {
        "userId": 3,
        "id": 47,
        'time': '12:24',
        "title": "nam qui rerum fugiat accusamus",
        "completed": false
    },
    {
        "userId": 3,
        "id": 48,
        'time': '12:24',
        "title": "sit reprehenderit omnis quia",
        "completed": false
    },
    {
        "userId": 3,
        "id": 49,
        'time': '12:24',
        "title": "ut necessitatibus aut maiores debitis officia blanditiis velit et",
        "completed": false
    },
    {
        "userId": 3,
        "id": 50,
        'time': '12:23',
        "title": "cupiditate necessitatibus ullam aut quis dolor voluptate",
        "completed": true
    },
    {
        "userId": 3,
        "id": 51,
        'time': '12:23',
        "title": "distinctio exercitationem ab doloribus",
        "completed": false
    },
    {
        "userId": 3,
        "id": 52,
        'time': '12:23',
        "title": "nesciunt dolorum quis recusandae ad pariatur ratione",
        "completed": false
    },
    {
        "userId": 3,
        "id": 53,
        'time': '12:23',
        "title": "qui labore est occaecati recusandae aliquid quam",
        "completed": false
    },
    {
        "userId": 3,
        "id": 54,
        'time': '12:23',
        "title": "quis et est ut voluptate quam dolor",
        "completed": true
    },
    {
        "userId": 3,
        "id": 55,
        'time': '12:23',
        "title": "voluptatum omnis minima qui occaecati provident nulla voluptatem ratione",
        "completed": true
    },
    {
        "userId": 3,
        "id": 56,
        'time': '12:23',
        "title": "deleniti ea temporibus enim",
        "completed": true
    },
    {
        "userId": 3,
        "id": 57,
        'time': '12:23',
        "title": "pariatur et magnam ea doloribus similique voluptatem rerum quia",
        "completed": false
    },
    {
        "userId": 3,
        "id": 58,
        'time': '12:23',
        "title": "est dicta totam qui explicabo doloribus qui dignissimos",
        "completed": false
    },
    {
        "userId": 3,
        "id": 59,
        'time': '12:23',
        "title": "perspiciatis velit id laborum placeat iusto et aliquam odio",
        "completed": false
    },
    {
        "userId": 3,
        "id": 60,
        'time': '12:23',
        "title": "et sequi qui architecto ut adipisci",
        "completed": true
    },
    {
        "userId": 4,
        "id": 61,
        'time': '12:23',
        "title": "odit optio omnis qui sunt",
        "completed": true
    },
    {
        "userId": 4,
        "id": 62,
        "title": "et placeat et tempore aspernatur sint numquam",
        "completed": false
    },
    {
        "userId": 4,
        "id": 63,
        'time': '12:23',
        "title": "doloremque aut dolores quidem fuga qui nulla",
        "completed": true
    },
    {
        "userId": 4,
        "id": 64,
        'time': '12:23',
        "title": "voluptas consequatur qui ut quia magnam nemo esse",
        "completed": false
    },
    {
        "userId": 4,
        "id": 65,
        'time': '12:23',
        "title": "fugiat pariatur ratione ut asperiores necessitatibus magni",
        "completed": false
    },
    {
        "userId": 4,
        "id": 66,
        'time': '12:23',
        "title": "rerum eum molestias autem voluptatum sit optio",
        "completed": false
    },
    {
        "userId": 4,
        "id": 67,
        'time': '12:23',
        "title": "quia voluptatibus voluptatem quos similique maiores repellat",
        "completed": false
    },
    {
        "userId": 4,
        "id": 68,
        'time': '12:23',
        "title": "aut id perspiciatis voluptatem iusto",
        "completed": false
    },
    {
        "userId": 4,
        "id": 69,
        'time': '12:23',
        "title": "doloribus sint dolorum ab adipisci itaque dignissimos aliquam suscipit",
        "completed": false
    },
    {
        "userId": 4,
        "id": 70,
        'time': '12:23',
        "title": "ut sequi accusantium et mollitia delectus sunt",
        "completed": false
    },
    {
        "userId": 4,
        "id": 71,
        'time': '12:23',
        "title": "aut velit saepe ullam",
        "completed": false
    },
    {
        "userId": 4,
        "id": 72,
        'time': '12:23',
        "title": "praesentium facilis facere quis harum voluptatibus voluptatem eum",
        "completed": false
    },
    {
        "userId": 4,
        "id": 73,
        "title": "sint amet quia totam corporis qui exercitationem commodi",
        "completed": true
    },
    {
        "userId": 4,
        "id": 74,
        'time': '12:23',
        "title": "expedita tempore nobis eveniet laborum maiores",
        "completed": false
    },
    {
        "userId": 4,
        "id": 75,
        'time': '12:23',
        "title": "occaecati adipisci est possimus totam",
        "completed": false
    },
    {
        "userId": 4,
        "id": 76,
        'time': '12:23',
        "title": "sequi dolorem sed",
        "completed": true
    },
    {
        "userId": 4,
        "id": 77,
        'time': '12:23',
        "title": "maiores aut nesciunt delectus exercitationem vel assumenda eligendi at",
        "completed": false
    },
    {
        "userId": 4,
        "id": 78,
        'time': '12:23',
        "title": "reiciendis est magnam amet nemo iste recusandae impedit quaerat",
        "completed": false
    },
    {
        "userId": 4,
        "id": 79,
        'time': '12:23',
        "title": "eum ipsa maxime ut",
        "completed": true
    },
    {
        "userId": 4,
        "id": 80,
        'time': '12:23',
        "title": "tempore molestias dolores rerum sequi voluptates ipsum consequatur",
        "completed": true
    },
    {
        "userId": 5,
        "id": 81,
        'time': '12:23',
        "title": "suscipit qui totam",
        "completed": true
    },
    {
        "userId": 5,
        "id": 82,
        'time': '12:23',
        "title": "voluptates eum voluptas et dicta",
        "completed": false
    },
    {
        "userId": 5,
        "id": 83,
        'time': '12:23',
        "title": "quidem at rerum quis ex aut sit quam",
        "completed": true
    },
    {
        "userId": 5,
        "id": 84,
        'time': '12:23',
        "title": "sunt veritatis ut voluptate",
        "completed": false
    },
    {
        "userId": 5,
        "id": 85,
        'time': '12:23',
        "title": "et quia ad iste a",
        "completed": true
    },
    {
        "userId": 5,
        "id": 86,
        'time': '12:23',
        "title": "incidunt ut saepe autem",
        "completed": true
    },
    {
        "userId": 5,
        "id": 87,
        'time': '12:23',
        "title": "laudantium quae eligendi consequatur quia et vero autem",
        "completed": true
    },
    {
        "userId": 5,
        "id": 88,
        'time': '12:23',
        "title": "vitae aut excepturi laboriosam sint aliquam et et accusantium",
        "completed": false
    },
    {
        "userId": 5,
        "id": 89,
        'time': '12:23',
        "title": "sequi ut omnis et",
        "completed": true
    },
    {
        "userId": 5,
        "id": 90,
        'time': '12:23',
        "title": "molestiae nisi accusantium tenetur dolorem et",
        "completed": true
    },
    {
        "userId": 5,
        "id": 91,
        'time': '12:23',
        "title": "nulla quis consequatur saepe qui id expedita",
        "completed": true
    },
    {
        "userId": 5,
        "id": 92,
        'time': '12:23',
        "title": "in omnis laboriosam",
        "completed": true
    },
    {
        "userId": 5,
        "id": 93,
        "title": "odio iure consequatur molestiae quibusdam necessitatibus quia sint",
        "completed": true
    },
    {
        "userId": 5,
        "id": 94,
        "title": "facilis modi saepe mollitia",
        "completed": false
    },
    {
        "userId": 5,
        "id": 95,
        'time': '12:23',
        "title": "vel nihil et molestiae iusto assumenda nemo quo ut",
        "completed": true
    },
    {
        "userId": 5,
        "id": 96,
        'time': '12:23',
        "title": "nobis suscipit ducimus enim asperiores voluptas",
        "completed": false
    },
    {
        "userId": 5,
        "id": 97,
        'time': '12:23',
        "title": "dolorum laboriosam eos qui iure aliquam",
        "completed": false
    },
    {
        "userId": 5,
        "id": 98,
        'time': '12:23',
        "title": "debitis accusantium ut quo facilis nihil quis sapiente necessitatibus",
        "completed": true
    },
    {
        "userId": 5,
        "id": 99,
        'time': '12:23',
        "title": "neque voluptates ratione",
        "completed": false
    },
]

let course_modal = document.querySelector('.course-modal')
let bg_modal = document.querySelector('.bg-modal')
let body = document.querySelector('body')
let form = document.querySelector('form')
let main__ap
let main__ap_done
let concerdone = 0
let concernotdone = 0
let options = document.querySelectorAll('option')
let search_inp = document.querySelector('input')
let checkbox
body.style.overflow = 'hidden'

const createMain = (what) => {
    let main = document.querySelector('main')
    let main__top = `<section class="left mg__r">
    <p class="main__p"> Is not Done! - <span class="num">4</span></p>
    <div class="main__ap greed">
    </div>
    </section>`
    let main__boot =
        `<div class="line"></div>
    <section class="raight">
    <p class="main__p">Is Done! - <span class="num__done">4</span></p>
    <div class="main__ap_done greed">
    </div>
    </section>`

    if (what == 'alldone') {
        main.innerHTML = main__top + main__boot
        main__ap = document.querySelector('.main__ap')
        main__ap_done = document.querySelector('.main__ap_done')
    } else if (what == 'done') {
        main.innerHTML = main__top
        main__ap = document.querySelector('.main__ap')
    } else {
        main.innerHTML = main__boot
        main__ap_done = document.querySelector('.main__ap_done')
    }


    clear(what)
}
const clear = (what) => {
    if (what == 'alldone') {
        main__ap.innerHTML = ' '
        main__ap_done.innerHTML = ' '
        concerdone = 0
        concernotdone = 0
    } else if (what == 'done') {
        main__ap.innerHTML = ' '
        concerdone = 0
    } else {
        main__ap_done.innerHTML = ' '
        concernotdone = 0
    }
}

const Createbloke = (bloke, elemnt, comlited__or__not, text, yes, what) => {
    elemnt.innerHTML += `<div class="item">
    <h2>${bloke.title}</h2>
    <span class="time">${bloke.time}</span>
    <div class="inp__with__p">
    <input type="checkbox" ${yes} id='${bloke.id}'>
    <p class="${comlited__or__not} def__chek" >${text}</p>
    </div>
    </div>`
    if (comlited__or__not == 'done') concerdone++
    else concernotdone++

    if (elemnt == main__ap_done) schet(concerdone, concernotdone, what)
    else schet(concerdone, concernotdone, what)

    checkbox = document.querySelectorAll('input[type="checkbox"]')

    for (const item of checkbox) {
        item.onclick = () => {
            whare__push()
        }
    }
}

const schet = (done__num, not__done, what) => {
    if (what == 'alldone') {
        let done__span = document.querySelector('.num__done')
        done__span.innerText = done__num
        let not__done__span = document.querySelector('.num')
        not__done__span.innerText = not__done
    } else if (what == 'notdone') {
        let done__span = document.querySelector('.num__done')
        done__span.innerText = done__num
    } else {
        let not__done__span = document.querySelector('.num')
        not__done__span.innerText = not__done
    }
}

const search = (arr, what) => {
    createMain(what)

    let arrStr = JSON.stringify(arr);
    localStorage.setItem('arr', arrStr);
    for (let item of arr) {
        if (item.completed == true && what == 'alldone') {
            Createbloke(item, main__ap_done, 'done', 'done', 'checked', what)
        } else {
            Createbloke(item, main__ap, 'not__done', 'not done', ' ', what)
        }
    }
}


let arr_plesholder_for_inp = ['Name', 'Time', 'Выберите готовность задачи']
let arr_name_for_inp = ['title', 'time', 'completed']
let option_TEXT = [true, false, ]

const createmobile = (input, text) => {
    form.innerHTML = ' '
    let inputmobail
    let h1mobil = document.createElement('h3')
    let buton = document.createElement('button')
    h1mobil.innerText = text
    buton.classList.add('create')
    buton.innerText = text
    form.append(h1mobil)
    for (let i = 0; i < input; i++) {
        inputmobail = document.createElement('input')
        inputmobail.setAttribute('type', 'text')
        inputmobail.setAttribute('placeholder', arr_plesholder_for_inp[i])
        inputmobail.setAttribute('name', arr_name_for_inp[i])
        if (i == 1) {
            inputmobail.setAttribute('type', 'time')
        }
        if (i == 2) {
            let select = document.createElement('select')
            select.setAttribute('name', 'complirted')
            for (let item of option_TEXT) {
                let option = document.createElement('option')
                option.innerText = item
                option.setAttribute('value', item)
                select.append(option)
            }
            form.append(select)
        }
        form.append(inputmobail)
    }
    inputmobail.remove()
    form.append(buton)
    anim()
    REGEX()
}

const closeModal = () => {
    bg_modal.style.opacity = "0"
    course_modal.style.opacity = "0"
    course_modal.style.width = "0px"
    course_modal.style.height = '0px'
    body.style.overflow = 'scroll'
    setTimeout(() => {
        bg_modal.style.display = "none"
        course_modal.style.display = "none"
        course_modal.classList.remove('mobail-modal')
    }, 100);
}

const showModal = (width, haight, input, text) => {
    bg_modal.style.display = "block"
    course_modal.style.display = "flex"
    body.style.overflow = 'hidden'
    course_modal.style.width = width
    course_modal.style.height = haight
    setTimeout(() => {
        bg_modal.style.opacity = "1"
        course_modal.style.opacity = "1"
    }, 100);

    setTimeout(() => {
        course_modal.classList.add('mobail-modal')
    }, 150);

    createmobile(input, text)
}

const anim = (butensclose) => {
    let butns = document.querySelectorAll('button[data-but]')
    for (const but of butns) {
        but.onclick = () => {
            let valueinnrTEXT = but.innerText
            let width = but.getAttribute('data-with')
            let haight = but.getAttribute('data-haight')
            let input = but.getAttribute('data-input')
            showModal(width, haight, input, valueinnrTEXT)
        }
    }
}

const REGEX = () => {
    form.onsubmit = () => {
        event.preventDefault()
        let fm = new FormData(form)
        let Create_New_Task = {
            id: Math.random,
        }
        fm.forEach((a, b) => {
            if (a == 'true' || a == 'false') {
                let bol = Boolean(a)
                Create_New_Task[b] = bol
            }
            Create_New_Task[b] = a
        })
        let butensclose = document.querySelectorAll('.create')
        for (const but of butensclose) {
            but.onclick = () => {
                closeModal()
                arr.push(Create_New_Task);

                search(arr)
            }
        }
    }
}
let times = setTimeout(() => {
    checkbox = document.querySelectorAll('input[type="checkbox"]')
}, 10);


const local__search = (Whare) => {
    checkbox = document.querySelectorAll('input[type="checkbox"]')
    let arr2 = localStorage.getItem('arr');
    const obj = JSON.parse(arr2);
    if (obj == null) {
        search(arr, Whare)
        search__item(obj, Whare)
        chekbox(arr, Whare)
    } else {
        search(obj, Whare)
        chekbox(obj, Whare)
        search__item(obj, Whare)
        search__item(obj, Whare)
    }
}

const whare__push = () => {
    let value__select = document.getElementById("months").value

    local__search(value__select)
}

const chekbox = (mass, Whare) => {
    checkbox = document.querySelectorAll('input[type="checkbox"]')

    for (const item of checkbox) {
        item.onclick = () => {
            let id = +item.getAttribute('id')
            let find = mass.find(item => item.id == id)
            let idx = mass.indexOf(find)
            if (mass[idx].completed == true) mass[idx].completed = false
            else mass[idx].completed = true
            search(mass, Whare)
        }
    }
}

const search__item = (mass, Whare) => {
    search_inp.onkeyup = () => {
        let find = mass.find(item => search_inp.value == item.title)
        let obj2 = []
        obj2.push(find)
        clear()
        for (let item of obj2) {
            if (item.completed == true) {
                Createbloke(item, main__ap_done, 'done', 'done', 'checked')
            } else {
                Createbloke(item, main__ap, 'not__done', 'not done', ' ', )
            }
        }
    }
}
let bg_daler_aka = document.querySelector('.bg-daler-aka')
let dleraka = document.querySelector('.dleraka')

setTimeout(() => {
    dleraka.style.display = 'none'
    bg_daler_aka.style.display = 'none'
    body.style.overflow = 'scroll'
}, 5000);


document.addEventListener("DOMContentLoaded", function () {
    document.getElementById("elem").onclick = function () {
        whare__push()
    };
});



whare__push()
anim([])